function setLocalStorage(name,value,duration){if(localStorage.setItem(name,value),duration){var data=new Date;data.setDate(data.getDate()+parseInt(duration)),localStorage.setItem(name+"_timer",data)}}function getLocalStorage(name,timer){return timer?localStorage.getItem(name+"_timer"):localStorage.getItem(name)}function deleteLocalStorage(name,timer){localStorage.removeItem(name),timer&&localStorage.removeItem(name+"_timer")}$(document).ready((function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$((function(){$(".max-caracteres").each((function(){var max_caracteres=$(this).data("max_caracteres")||255;$(this).parent().find("label").append('<span class="ml-2 count-max-caracteres-length">(max. caracteres '+max_caracteres+")</span>")}))})),$(document).on("keydown",".max-caracteres",(function(e){var max_caracteres=$(this).data("max_caracteres")||255;if($(this).parent().find(".count-max-caracteres-length").html("(max. caracteres "+(max_caracteres-$(this).val().length)+")"),$(this).val().length>=max_caracteres&&8!=e.keyCode&&9!=e.keyCode)return!1})),$('[name="birth_date"]').mask("00/00/0000"),$('[name="post_code"]').mask("00000-000"),$('[name="number"]').mask("0000000000"),$('[name="phone1"]').mask("(00) 0000-0000"),$('[name="phone2"]').mask("(00) 00000-0000"),$(".card").mask("0000 0000 0000 0000"),$(".expiration_month").mask("00"),$(".expiration_year").mask("0000"),$(".cvv").mask("000"),$(".real").maskMoney({precision:2,decimal:",",thousands:""}),$(".select2").select2();var options={onKeyPress:function(cpf,ev,el,op){var masks=["000.000.000-000","00.000.000/0000-00"];$('[name="cnpj_cpf"]').mask(cpf.length>14?masks[1]:masks[0],op)}},options2={onKeyPress:function(cpf,ev,el,op){var masks=["000000000000","00000000000000"];$('[name="cnpj_cpf2"]').mask(cpf.length>11?masks[1]:masks[0],op)}};function calcula_campo_project(data){var width=data.parent().parent().find(".project-width");width=parseFloat(width.val().replace(",","."))||0;var height=data.parent().parent().find(".project-height");height=parseFloat(height.val().replace(",","."))||0;var square=data.parent().parent().find(".project-square"),modulo=data.parent().parent().find(".customModuloProject"),text_square=data.parent().parent().find(".text-square"),type_calc=$('[name="prodcuct_project"]:checked').val();if(width&&height){"centimeters"==type_calc&&(width/=100,height/=100);var cont_square=width*height;square.val(cont_square.toFixed(2)),modulo.val(width+"|"+height+"|"+cont_square.toFixed(2)),text_square.html(cont_square.toFixed(2).toString().replace(".",",")+" m²")}}$('[name="cnpj_cpf"]').length>11?$('[name="cnpj_cpf"]').mask("00.000.000/0000-00",options):$('[name="cnpj_cpf"]').mask("000.000.000-00#",options),$('[name="cnpj_cpf2"]').length>11?$('[name="cnpj_cpf2"]').mask("00000000000000",options2):$('[name="cnpj_cpf2"]').mask("00000000000#",options2),$('[name="cnpj_cpf"], [name="cnpj_cpf2"]').blur((function(){var thiss=$(this),cpf_cnpj=$(this).val();cpf_cnpj&&(valida_cpf_cnpj(cpf_cnpj)||Swal.fire({icon:"error",text:"CNPJ/CPF informado invalido!"}).then(result=>{}))})),$((function(){$('[name="state"]')&&$.ajax({url:"https://servicodados.ibge.gov.br/api/v1/localidades/estados/",type:"GET",success:data=>{for(var i=0;data.length>i;i++)$('[name="state"]').append('<option value="'+data[i].sigla+'" data-sigla_id="'+data[i].id+'">'+data[i].sigla+" - "+data[i].nome+"</option>")}})})),$(document).on("change",'[name="state"]',(function(){let sigla_id=$(this).find(":selected").data("sigla_id"),select=$(this).parent().parent().find('select[name="city"]');$.ajax({url:"https://servicodados.ibge.gov.br/api/v1/localidades/estados/"+sigla_id+"/municipios",type:"GET",success:data=>{select.empty(),select.append('<option value="">::Selecione uma Opção::</option>');for(var i=0;data.length>i;i++)select.append('<option value="'+data[i].nome+'">'+data[i].nome+"</option>")}})})),$('[name="post_code"]').on("keyup blur",(function(){$(this).parent().parent().find("input, select").attr("readonly",!1),$(this).parent().parent().find("input, select").trigger("change"),9==$(this).val().length&&($(".loadCep").removeClass("d-none"),$.ajax({url:"/cep/"+$(this).val(),type:"GET",success:data=>{$('[name="address"]').val(data.logradouro),data.logradouro&&$('[name="address"]').prop("readonly",!0),$('[name="address2"]').val(data.bairro),data.bairro&&$('[name="address2"]').prop("readonly",!0),$('[name="state"]').val(data.uf),data.uf&&($('[name="state"]').attr("readonly",!0),$('[name="state"]').trigger("change")),setTimeout(()=>{$('[name="city"]').val(data.localidade),data.localidade&&($('[name="city"]').attr("readonly",!0),$('[name="city"]').trigger("change"))},800),$('[name="number"]').focus(),$(".loadCep").addClass("d-none")}}))})),$(".imagem-produto-1").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!0,asNavFor:".imagem-produto-2"}),$(".imagem-produto-2").slick({slidesToShow:3,asNavFor:".imagem-produto-1",dots:!0,centerMode:!0,focusOnSelect:!0}),$(".popover-dismiss").popover({trigger:"focus"}),$(document).on("click",'[data-target="#enderecos"]',(function(){$("#enderecos").find('[name="id"]').val(""),$("#enderecos").find('input[type="text"]').val(""),$("#enderecos").find("input").attr("readonly",!1),$("#enderecos").find("select").val(""),$("#enderecos").find("select").attr("readonly",!1);var dados=$(this).data("dados");$.each(dados,(key,value)=>{$("#enderecos").find('[name="'+key+'"').val(value)}),$("#enderecos").find('[name="post_code"]').trigger("keyup"),$("#enderecos").find("select").trigger("change")})),$(document).on("click",".btn-excluir-address",(function(e){e.preventDefault();var id=$(this).data("id"),url=$(this).data("url");Swal.fire({icon:"error",title:"Apagar Endereço?",showCancelButton:!0,confirmButtonText:"SIM",cancelButtonText:"NÃO"}).then(result=>{result.isConfirmed&&(window.location.href=url+"/"+id)})})),$(".copy-link").on("click",(function(e){e.preventDefault(),navigator.clipboard.writeText($(this).attr("href")),$(this).css({color:"green","border-color":"green"}),setTimeout(()=>{$(this).css({color:"#000","border-color":"#000",transition:"0.8s ease"})},5e3)})),$(document).on("click","#comprar_produto",(function(){var data={originalId:$("#originalId").val(),originalValue:$("#originalValue").val(),promotion:$("#promotion").val(),promotionValue:$("#promotionValue").val(),promotionPorcent:$("#promotionPorcent").val(),originalName:$("#originalName").val(),hasPreparation:$("#hasPreparation").val(),preparationTime:$("#preparationTime").val(),productImage:$("#productImage").val(),productWeight:$("#productWeight").val(),productHeight:$("#productHeight").val(),productWidth:$("#productWidth").val(),ProductLength:$("#ProductLength").val(),originalSalesUnit:$("#originalSalesUnit").val(),customProjectValue:$("#customProjectValue").val(),customProjectWidth:$("#customProjectWidth").val(),customProjectHeight:$("#customProjectHeight").val(),customProjectMeters:$("#customProjectMeters").val(),customValue:$("#customValue").val(),attributes_aux:[],project:[],qty_total:$(".qty_total").val(),note:$("#product_ob").val()};$(".select-data-attribute.attr-selecionado").each((function(){data.attributes_aux.push($(this).val())})),$(".customModuloProject").each((function(){data.project.push($(this).val())})),$(this).html('<div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div>'),$.ajax({url:"/carrinhoAdd",type:"POST",data:data,success:data=>{window.location.href="/carrinho"}})})),$(document).on("click",".btn-delete-product",(function(){var this_var=$(this),row_id=$(this).data("row_id"),repagina=$(this).data("repagina");$.ajax({url:"/carrinhoRemove",type:"POST",data:{row_id:row_id},success:data=>{"sim"==repagina?location.reload():this_var.parent().parent().remove()}})})),$(document).on("keyup",".project-width",(function(){var this_var;calcula_campo_project($(this))})),$(document).on("keyup",".project-height",(function(){var this_var;calcula_campo_project($(this))})),$(document).on("click",".btn-calc-project",(function(){var custom_width=0,custom_height=0,custom_square=0;$(".customModuloProject").each((function(){var custom=$(this).val().split("|");custom_width+=parseFloat(custom[0])||0,custom_height+=parseFloat(custom[1])||0,custom_square+=parseFloat(custom[2])||0}));var custom_project_value=parseFloat($("#customProjectValue").val())||0,custom_value=parseFloat($("#customValue").val())||0;$("#customValue").val((custom_value-custom_project_value).toFixed(2));var custom_value=parseFloat($("#customValue").val())||0,originalValue=parseFloat($("#originalValue").val())||0;"S"==$("#promotion").val()&&(originalValue=parseFloat($("#promotionValue").val())||0);var custom_value2=custom_square*originalValue,total_attributes,total_attr_selecionado;$("#customProjectWidth").val(custom_width.toFixed(2)),$("#customProjectHeight").val(custom_height.toFixed(2)),$("#customProjectMeters").val(custom_square.toFixed(2)),$("#customProjectValue").val(custom_value2.toFixed(2)),$("#customValue").val((custom_value2+custom_value).toFixed(2)),$(".tela-projeto").html("<h4>"+custom_square.toFixed(2).toString().replace(".",",")+" m² - R$ "+custom_value2.toFixed(2).toString().replace(".",",")+"</h4>"),$(".attributes").length==$(".attributes").find(".attr-selecionado").length&&($(".valor-final").text("R$ "+(custom_value2+custom_value).toFixed(2).toString().replace(".",",")),$("#comprar_produto").prop("disabled",!1))})),$(document).on("click",'[name="prodcuct_project"]',(function(){var this_var=$(this).val();$(".project-campo-titulo, .project-campo, .btn-add-project-campo").removeClass("d-none"),$(".project-campo").html('<div class="row py-1"><input type="hidden" class="customModuloProject"><div class="col-3"><button type="button" class="btn btn-danger btn-sm remove-project-calc"><i class="fas fa-times"></i></button></div><div class="col-3"><input type="text" class="form-control form-control-sm project-width"></div><div class="col-3"><input type="text" class="form-control form-control-sm project-height"></div><div class="col-3 text-square"></div></div>'),"meters"==this_var?$(".project-width, .project-height").maskMoney({precision:2,decimal:",",thousands:"."}):"centimeters"==this_var&&$(".project-width, .project-height").maskMoney({precision:2,decimal:"",thousands:""}),$("#customProjectWidth").val(""),$("#customProjectHeight").val(""),$("#customProjectMeters").val(""),$(".tela-projeto").empty(),$(".valor-final").empty();var custom_project_value=parseFloat($("#customProjectValue").val())||0,custom_value=parseFloat($("#customValue").val())||0;$("#customValue").val((custom_value-custom_project_value).toFixed(2)),$("#customProjectValue").val(""),$("#comprar_produto").prop("disabled",!0)})),$(document).on("click",".btn-add-project-calc",(function(){$(".project-campo").append('<div class="row py-1"><input type="hidden" class="customModuloProject"><div class="col-3"><button type="button" class="btn btn-danger btn-sm remove-project-calc"><i class="fas fa-times"></i></button></div><div class="col-3"><input type="text" class="form-control form-control-sm project-width"></div><div class="col-3"><input type="text" class="form-control form-control-sm project-height"></div><div class="col-3 text-square"></div></div>');var this_var=$('[name="prodcuct_project"]:checked').val();"meters"==this_var?$(".project-width, .project-height").maskMoney({precision:2,decimal:",",thousands:"."}):"centimeters"==this_var&&$(".project-width, .project-height").maskMoney({precision:2,decimal:"",thousands:""})})),$(document).on("click",".remove-project-calc",(function(){$(this).parent().parent().remove()})),$(document).on("click",".select-attribute-bg",(function(){var this_var=$(this),custom_value=parseFloat($("#customValue").val())||0,attr_value;(attr_value=this_var.parent().parent().parent().find(".attr-selecionado")).length>0&&(attr_value=attr_value.val().split("|"),attr_value=parseFloat(attr_value[2])||0,$("#customValue").val((custom_value-attr_value).toFixed(2))),this_var.parent().parent().parent().find(".select-attribute").removeClass("active"),this_var.parent().parent().parent().find(".attr-selecionado").removeClass("attr-selecionado"),this_var.parent().parent().find(".select-data-attribute").addClass("attr-selecionado"),this_var.parent().addClass("active");var custom_value=parseFloat($("#customValue").val())||0,attr_value=this_var.parent().parent().find(".select-data-attribute").val().split("|");attr_value=parseFloat(attr_value[2])||0,$("#customValue").val((custom_value+attr_value).toFixed(2));var custom_project_value=parseFloat($("#customProjectValue").val())||0,total_attributes=$(".attributes").length,total_attr_selecionado=$(".attributes").find(".attr-selecionado").length;$("#comprar_produto").prop("disabled",!0),total_attributes==total_attr_selecionado&&0!==custom_project_value&&($(".valor-final").text("R$ "+(attr_value+custom_value).toFixed(2).toString().replace(".",",")),$("#comprar_produto").prop("disabled",!1))})),$(document).on("click",'[name="prodcuct_project_linear"]',(function(){var this_var=$(this).val();$(".project-campo").removeClass("d-none"),"meters"==this_var?$(".linear-meters").maskMoney({precision:2,decimal:",",thousands:"."}):"centimeters"==this_var&&$(".linear-meters").maskMoney({precision:2,decimal:"",thousands:""}),$("#customProjectMeters").val(""),$(".linear-meters").val(""),$(".tela-projeto").empty(),$(".valor-final").empty();var custom_project_value=parseFloat($("#customProjectValue").val())||0,custom_value=parseFloat($("#customValue").val())||0;$("#customValue").val((custom_value-custom_project_value).toFixed(2)),$("#customProjectValue").val(""),$("#comprar_produto").prop("disabled",!0)})),$(document).on("click",".btn-calc-meters",(function(){var custom_meters=parseFloat($(".linear-meters").val().replace(",","."))||0,custom_project_value=parseFloat($("#customProjectValue").val())||0,custom_value=parseFloat($("#customValue").val())||0;$("#customValue").val((custom_value-custom_project_value).toFixed(2));var custom_value=parseFloat($("#customValue").val())||0,originalValue=parseFloat($("#originalValue").val())||0;"S"==$("#promotion").val()&&(originalValue=parseFloat($("#promotionValue").val())||0);var custom_value2=custom_meters*originalValue,total_attributes,total_attr_selecionado;$("#customProjectMeters").val(custom_meters.toFixed(2)),$("#customProjectValue").val(custom_value2.toFixed(2)),$("#customValue").val((custom_value2+custom_value).toFixed(2)),$(".tela-projeto").html("<h4>"+custom_meters.toFixed(2).toString().replace(".",",")+" m - R$ "+custom_value2.toFixed(2).toString().replace(".",",")+"</h4>"),$(".attributes").length==$(".attributes").find(".attr-selecionado").length&&($(".valor-final").text("R$ "+(custom_value2+custom_value).toFixed(2).toString().replace(".",",")),$("#comprar_produto").prop("disabled",!1))})),$(".qty_plus").on("click",(function(){var plus=parseFloat($(".qty_total").val())+1;$(".qty_total").val(plus)})),$(".qty_minus").on("click",(function(){var minus=parseFloat($(".qty_total").val())||0;$(".qty_total").val()>=2&&(minus-=1),$(".qty_total").val(minus)})),$(document).on("click",'[name="transport"]',(function(){var frete_value=parseFloat($(this).val().split("|")[1])||0,sub_total=parseFloat($(".sub_total").val())||0;$(".frete").text("R$ "+frete_value.toFixed(2).toString().replace(".",",")),$(".total").text("R$ "+(frete_value+sub_total).toFixed(2).toString().replace(".",",")),$(".next-payment").prop("disabled",!1)})),$(document).on("click",".btn-visualizar",(function(){var target=$(this).data("target"),dados=$(this).data("dados");console.log(dados);var status_pagamento=dados.pay;$.each(dados,(key,value)=>{switch($(target).find("._"+key).text(value),"product_value"!=key&&"cost_freight"!=key&&"total_value"!=key||$(target).find("._"+key).text("R$ "+(parseFloat(value)||0).toFixed(2).toString().replace(".",",")),key){case"birth_date":var date=value.split("-");$(target).find("._"+key).text(date[2]+"/"+date[1]+"/"+date[0]);break;case"order_products":$(target).find(".produtos_pedido").empty();for(var i=0;i<value.length;i++){var attributes="";if(value[i].attributes)for(var ii=0;ii<value[i].attributes.length;ii++){var attr;attributes+='<div class="col-12">'+(attr=value[i].attributes[ii].split("|"))[1]+" - "+parseFloat(attr[2]||0).toFixed(2).toString().replace(".",",")+"</div>"}var project="";if(value[i].project)for(var ii=0;ii<value[i].project.length;ii++){var attr;project+='<div class="col-12">L: '+(attr=value[i].project[ii].split("|"))[0]+" - A: "+attr[1]+" - M²: "+attr[2]+"</div>"}$(target).find(".produtos_pedido").append('<div class="row border-bottom my-2"><div class="col-12 col-md-4"><b>Codigo do Produto: </b>'+value[i].product_code+'</div><div class="col-12 col-md-4"><b>Nome do Produto: </b>'+value[i].product_name+'</div><div class="col-12 col-md-4"><b>Quantidade: </b>'+value[i].quantity+'</div><div class="col-12 col-md-4"><b>Tipo de Venda: </b>'+value[i].product_sales_unit+'</div><div class="col-12 col-md-4"><b>Largura Padrão: </b>'+value[i].product_width+' cm</div><div class="col-12 col-md-4"><b>Altura Padrão: </b>'+value[i].product_height+' cm</div><div class="col-12 col-md-4"><b>Comprimento Padrão: </b>'+value[i].product_length+' cm</div><div class="col-12 col-md-4"><b>Peso Padrão: </b>'+value[i].product_weight+' kg</div><div class="col-12"><h5>Calculo do projeto</h5></div><div class="col-12 col-md-4"><b>Largura do Projeto: </b>'+value[i].project_width+'</div><div class="col-12 col-md-4"><b>Altura do Projeto: </b>'+value[i].project_height+'</div><div class="col-12 col-md-4"><b>M² do Projeto: </b>'+value[i].project_meters+'</div><div class="col-12 my-2"><h5>Atributos</h5></div><div class="col-12 col-md-4"><div class="row">'+attributes+'</div></div><div class="col-12 my-2"><h5>Projeto</h5></div><div class="col-12 col-md-4"><div class="row">'+project+"</div></div></div>")}break;case"shipping_customer":$(target).find(".entrega_pedido").empty(),$(target).find(".entrega_pedido").append('<div class="row border-bottom my-2"><div class="col-12 col-md-6">'+value[0].address+", Nª "+value[0].number+" - "+value[0].address2+'</div><div class="col-12 col-md-6">'+value[0].city+" / "+value[0].state+" - "+value[0].post_code+'</div><div class="col-12">'+value[0].phone1+" / "+value[0].phone2+'</div><div class="col-12 col-md-4"><b>Transportadora: </b>'+value[0].transport+" - <b>Data Estimada: </b> "+value[0].time+" dias</div></div>");break;case"payment_order":$(target).find(".pagamento_pedido").empty();for(var i=0;i<value.length;i++)$(target).find(".pagamento_pedido").append('<div class="row border-bottom my-2"><div class="col-12 col-md-4"><b>Total Pago: </b>'+((parseFloat(value[i].total_paid_amount)||0)/100).toFixed(2).toString().replace(".",",")+'</div><div class="col-12 col-md-4"><b>Parcelamento: </b>'+value[i].installments+" x "+((parseFloat(value[i].installment_amount)||0)/100).toFixed(2).toString().replace(".",",")+'</div><div class="col-12 col-md-4"><b>Metodo de Pagamento: </b>'+value[i].payment_method_id+"</div></div>");"0"==status_pagamento&&("boleto"==value[0].payment_method_id&&$.ajax({url:"https://api.pagar.me/1/transactions/"+value[0].payment_id,type:"GET",data:{api_key:"ak_test_RiK4hmGIp7sIB3PCClAEnKZwNPwxrm"},success:data=>{var boleto_expiration_date=new Date(data.boleto_expiration_date),boleto_url=data.boleto_url;$(target).find(".pagamento_pedido").append(`\n                                        <div class="my-2">\n                                            <a target="_blank" class="btn btn-success" href="${boleto_url}">Pagar Boleto</a>\n                                            <span>data de vencimento ${boleto_expiration_date.getDate()}-${boleto_expiration_date.getMonth()+1}-${boleto_expiration_date.getFullYear()}</span>\n                                        </div>\n                                    `)}}),"pix"==value[0].payment_method_id&&$.ajax({url:"https://api.pagar.me/1/transactions/"+value[0].payment_id,type:"GET",data:{api_key:"ak_test_RiK4hmGIp7sIB3PCClAEnKZwNPwxrm"},success:data=>{var pix_expiration_date=new Date(data.pix_expiration_date),pix_qr_code=data.pix_qr_code,pix=$.ajax({url:"/generateQrCode/"+btoa(pix_qr_code),type:"GET",async:!1});$(target).find(".pagamento_pedido").append(`\n                                        <style>\n                                            .qrcode svg {\n                                                width: 240px;\n                                                height: 240px;\n                                            }\n                                        </style>\n                                        <div class="my-2">\n                                            <button class="btn btn-success" onclick="copyQrCode()">copiar codigo pix</button>\n                                            <br>\n                                            <span>data de vencimento ${pix_expiration_date.getDate()}-${pix_expiration_date.getMonth()+1}-${pix_expiration_date.getFullYear()}</span>\n                                            <div class="qrcode">${atob(pix.responseJSON)}</div>\n                                            <script>\n                                                function copyQrCode() {\n                                                    /* Copy the text inside the text field */\n                                                    navigator.clipboard.writeText("${pix_qr_code}");\n                                                }\n                                            <\/script>\n                                        </div>\n                                    `)}}))}})})),$(document).on("click",".btn-add-coupon",(function(){var thiss=$(this),coupon=thiss.parent().parent().find("input").val();""!==coupon&&(thiss.parent().parent().find("input,button").prop("disabled",!0),thiss.html('<div class="spinner-border" role="status"></div>'),$.ajax({url:"/aplicarCupom",type:"POST",data:{coupon:coupon},success:data=>{console.log(data),$(".sub_total").val(parseFloat(data.value).toFixed(2)),$(".campo-valor-coupon").text(parseFloat(data.desconto).toFixed(2).toString().replace(".",",")),$(".total").text(parseFloat(data.value).toFixed(2).toString().replace(".",",")),$(".coupon-d").removeClass("d-none"),thiss.parent().parent().parent().addClass("d-none"),thiss.parent().parent().find("input,button").prop("disabled",!1),thiss.html("Adicionar"),$(".frete").html(""),$('[name="transport"]').prop("checked",!1),$(".next-payment").prop("disabled",!0)},error:err=>{Swal.fire({icon:"error",title:err.responseJSON.erro}),thiss.parent().parent().find("input,button").prop("disabled",!1),thiss.html("Adicionar")}}))})),$(".btn-yes-cookie").on("click",(function(){$(".modal-cookie").css({height:"0",transition:".6s height"}),setLocalStorage("cookie_privacy_policy","accept","30")})),$((function(){setTimeout(()=>{var height="100px";$(window).width()<1200&&(height="120px"),$(window).width()<1e3&&(height="140px"),$(window).width()<800&&(height="180px"),$(window).width()<600&&(height="260px"),$(window).width()<400&&(height="300px"),getLocalStorage("cookie_privacy_policy")?new Date(getLocalStorage("cookie_privacy_policy",!0))<new Date&&(deleteLocalStorage("cookie_privacy_policy",!0),$(".modal-cookie").css("height",height)):$(".modal-cookie").css("height",height)},1e3)}))}));